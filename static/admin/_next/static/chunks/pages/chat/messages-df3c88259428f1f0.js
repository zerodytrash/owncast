(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[145],{9007:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat/messages",function(){return n(40625)}])},40625:function(e,t,n){"use strict";n.r(t),n.d(t,{OUTCOME_TIMEOUT:function(){return E},default:function(){return A}});var r=n(34051),i=n.n(r),s=n(85893),a=n(67294),o=n(84916),u=n(71577),c=n(6551),l=n(89739),f=n(21640),d=n(94184),m=n.n(d),h=n(58091),p=n(58827),v=n(2766),y=n(94199),g=n(99611),b=n(90420);function w(e,t,n,r,i,s,a){try{var o=e[s](a),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){x(e,t,n[t])}))}return e}function O(e){var t=e.isVisible,n=e.message,r=e.setMessage;if(!n||(0,v.Qr)(n))return null;var o=null,c=(0,a.useState)(0),d=c[0],m=c[1],h=(n||{}).id;(0,a.useEffect)((function(){return function(){clearTimeout(o)}}));var x=function(){var e,s=(e=i().mark((function e(){var s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(o),m(0),e.next=4,(0,p.rQ)(p.hn,{auth:!0,method:"POST",data:{visible:!t,idArray:[h]}});case 4:(s=e.sent).success&&"changed"===s.message?(r(j({},n,{visible:!t})),m(1)):(r(j({},n,{visible:t})),m(-1)),o=setTimeout((function(){m(0)}),E);case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function a(e){w(s,r,i,a,o,"next",e)}function o(e){w(s,r,i,a,o,"throw",e)}a(void 0)}))});return function(){return s.apply(this,arguments)}}(),O=(0,s.jsx)(l.Z,{style:{color:"transparent"}});d&&(O=d>0?(0,s.jsx)(l.Z,{style:{color:"var(--ant-success)"}}):(0,s.jsx)(f.Z,{style:{color:"var(--ant-warning)"}}));var S="Click to ".concat(t?"hide":"show"," this message");return(0,s.jsxs)("div",{className:"toggle-switch ".concat(t?"":"hidden"),children:[(0,s.jsx)("span",{className:"outcome-icon",children:O}),(0,s.jsx)(y.Z,{title:S,placement:"topRight",children:(0,s.jsx)(u.Z,{shape:"circle",size:"small",type:"text",icon:t?(0,s.jsx)(g.Z,{}):(0,s.jsx)(b.Z,{}),onClick:x})})]})}var S=n(31386);function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t,n,r,i,s,a){try{var o=e[s](a),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function P(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function a(e){k(s,r,i,a,o,"next",e)}function o(e){k(s,r,i,a,o,"throw",e)}a(void 0)}))}}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){T(e,t,n[t])}))}return e}function Z(e){return function(e){if(Array.isArray(e))return N(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var _=o.Z.Title;var E=3e3;function A(){var e=(0,a.useState)([]),t=e[0],n=e[1],r=(0,a.useState)([]),o=r[0],d=r[1],y=(0,a.useState)(!1),g=y[0],b=y[1],w=(0,a.useState)(null),x=w[0],j=w[1],N=(0,a.useState)(""),k=N[0],T=N[1],A=null,I=null,M=function(){var e=P(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,p.rQ)(p.WE,{auth:!0});case 3:t=e.sent,(0,v.Qr)(t)?n([]):n(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("==== error",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){return M(),I=setInterval((function(){M()}),p.NE),function(){clearTimeout(A),clearTimeout(I)}}),[]);var z=function(e){return e.reduce((function(e,t){var n=t.user.id;return e.some((function(e){return e.text===n}))||e.push({text:n,value:n}),e}),[]).sort((function(e,t){var n=e.text.toUpperCase(),r=t.text.toUpperCase();return n<r?-1:n>r?1:0}))}(t),D={selectedRowKeys:o,onChange:function(e){d(e)}},U=function(e){var r=t.findIndex((function(t){return t.id===e.id}));t.splice(r,1,e),n(Z(t))},Q=function(){A=setTimeout((function(){j(null),T("")}),E)},H=function(){var e=P(i().mark((function e(r){var a,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.next=3,(0,p.rQ)(p.hn,{auth:!0,method:"POST",data:{visible:r,idArray:o}});case 3:(a=e.sent).success&&"changed"===a.message?(j((0,s.jsx)(l.Z,{})),Q(),u=Z(t),o.map((function(e){var n=u.findIndex((function(t){return t.id===e})),i=C({},t[n],{visible:r});return u.splice(n,1,i),null})),n(u),d([])):(j((0,s.jsx)(f.Z,{})),Q()),b(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=[{title:"Time",dataIndex:"timestamp",key:"timestamp",className:"timestamp-col",defaultSortOrder:"descend",render:function(e){var t=new Date(e);return(0,h.Z)(t,"PP pp")},sorter:function(e,t){return new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime()},width:90},{title:"User",dataIndex:"user",key:"user",className:"name-col",filters:z,onFilter:function(e,t){return t.user.id===e},sorter:function(e,t){return e.user.displayName.localeCompare(t.user.displayName)},sortDirections:["ascend","descend"],ellipsis:!0,render:function(e){var t=e.displayName;return(0,s.jsx)(S.Z,{user:e,children:t})},width:110},{title:"Message",dataIndex:"body",key:"body",className:"message-col",width:320,render:function(e){return(0,s.jsx)("div",{className:"message-contents",dangerouslySetInnerHTML:{__html:e}})}},{title:"",dataIndex:"hiddenAt",key:"hiddenAt",className:"toggle-col",filters:[{text:"Visible messages",value:!0},{text:"Hidden messages",value:!1}],onFilter:function(e,t){return t.visible===e},render:function(e,t){return(0,s.jsx)(O,{isVisible:!e,message:t,setMessage:U})},width:30}],F=m()({"bulk-editor":!0,active:o.length});return(0,s.jsxs)("div",{className:"chat-messages",children:[(0,s.jsx)(_,{children:"Chat Messages"}),(0,s.jsx)("p",{children:"Manage the messages from viewers that show up on your stream."}),(0,s.jsxs)("div",{className:F,children:[(0,s.jsx)("span",{className:"label",children:"Check multiple messages to change their visibility to: "}),(0,s.jsx)(u.Z,{type:"primary",size:"small",shape:"round",className:"button",loading:"show"===k&&g,icon:"show"===k&&x,disabled:!o.length||k&&"show"!==k,onClick:function(){T("show"),H(!0)},children:"Show"}),(0,s.jsx)(u.Z,{type:"primary",size:"small",shape:"round",className:"button",loading:"hide"===k&&g,icon:"hide"===k&&x,disabled:!o.length||k&&"hide"!==k,onClick:function(){T("hide"),H(!1)},children:"Hide"})]}),(0,s.jsx)(c.Z,{size:"small",className:"table-container",pagination:{defaultPageSize:100,showSizeChanger:!0},scroll:{y:540},rowClassName:function(e){return e.hiddenAt?"hidden":""},dataSource:t,columns:V,rowKey:function(e){return e.id},rowSelection:D})]})}}},function(e){e.O(0,[662,551,91,308,464,774,888,179],(function(){return t=9007,e(e.s=t);var t}));var t=e.O();_N_E=t}]);